# cloud_sprint

## Техническое задание
Сервис предназначен для хранения, загрузки и управления файлами с аутентификацией пользователей. 
Пользователи могут регистрироваться, авторизовываться, загружать/выгружать файлы, просматривать их список и удалять.
Должна быть обеспечена изолированнойть данных и возможность многопользовательсткой работы.

*Функции продукта*
1. Регистрация/авторизация :
   
- Создание учетной записи с логином, паролем, именем и фамилией.
- Вход в систему по логину и паролю.

3. Управление файлами :
   
- Загрузка/выгрузка файлов на сервер.
- Просмотр списка загруженных файлов (название, размер).
- Удаление файлов.

*Описание интерфейса пользователя*

Веб-интерфейс :

- Страница входа (/login): Форма для аутентификации.
- Страница регистрации (/signup): Форма создания учетной записи.
- Главная страница (/home):
- Форма загрузки файлов.
- Список файлов пользователя с кнопками удаления и выгрузки.

*Требования к внешним интерфейсам*

*Эндпоинты :*

- POST /signup — регистрация (параметры: username, password, firstName, lastName).
- POST /login — аутентификация (параметры: username, password).
- POST /home/upload — загрузка файла.
- POST /home/delete/{id} — удаление файла по ID.
- GET /hom/download/{id} - выгрузка файла с сервера.
- GET /home — отображение списка файлов.

*Формат данных :*

- Входные данные: HTML-формы.
- Выходные данные: HTML-страницы с использованием Thymeleaf.

*Оценка нагрузки*

- Ожидаемая нагрузка : До 10 активных пользователей.


# Техническое описание сервиса 

Архитектура

### Текстовое описание компонентов
- **Контроллеры**:
  - `HomeController`: Управляет загрузкой, скачиванием, удалением файлов и отображением домашней страницы.
  - `LoginController`/`SignupController`: Обрабатывают аутентификацию и регистрацию.
  - `ProgressController`: Обеспечивает отслеживание прогресса загрузки через Server-Sent Events (SSE).
- **Сервисы**:
  - `FileService`: Логика работы с файлами (сохранение, удаление, получение метаданных).
  - `UserService`: Управление пользователями и их директориями.
- **Модели**:
  - `File`: Сущность файла с метаданными.
  - `Users`: Сущность пользователя, реализующая `UserDetails`.
  - `FileUploadProgressListener`: Отслеживает прогресс загрузки.
- **Репозитории**:
  - `FileRepository`/`UserRepository`: Интерфейсы для работы с БД.
- **Безопасность**:
  - `SecurityConfig`: Настройка доступа и аутентификации.
  - `UserDetailsServiceImpl`: Загрузка данных пользователя из БД.

Диаграмма компонентов : 

![111](https://github.com/user-attachments/assets/4de51e19-06dc-4b36-8afb-47835306b28d)

Взаимодействие:  
Пользователь взаимодействует с контроллерами через HTTP-запросы. Контроллеры делегируют бизнес-логику сервисам, которые используют репозитории для работы с БД. Данные хранятся в PostgreSQL, файлы — в локальной файловой системе.

Диаграмма классов :

![image](https://github.com/user-attachments/assets/1eeae9a0-17ed-4cb3-8beb-00412d7f0114)

Классы и их назначение:

Контроллеры:

`HomeController`
Функция: Управляет домашней страницей.
Цель: Отображает список файлов пользователя, обрабатывает загрузку, скачивание и удаление файлов. Проверяет аутентификацию пользователя.

`LoginController`
Функция: Отвечает за вход в систему.
Цель: Отображает форму входа и перенаправляет аутентифицированных пользователей на домашнюю страницу.

`SignupController`
Функция: Регистрирует новых пользователей.
Цель: Проверяет уникальность логина, сохраняет данные пользователя в БД и создает личную папку для файлов.

`ProgressController`
Функция: Отслеживает прогресс загрузки файлов.
Цель: Использует SSE (Server-Sent Events) для передачи процента завершенности загрузки в реальном времени.

Сервисы:

`FileService`
Функция: Управляет файлами пользователя.
Цель: Сохраняет файлы в файловую систему, удаляет их, извлекает метаданные. Интегрирован с FileUploadProgressListener для отслеживания прогресса.

`UserService`
Функция: Работает с пользователями.
Цель: Создает новых пользователей, шифрует пароли, создает персональные директории. Проверяет уникальность логина.

Модели:

`File`
Функция: Хранит метаданные файла.
Цель: Связывает файл с пользователем. Содержит информацию о названии, размере, пути и типе файла.

`Users`
Функция: Представляет пользователя системы.
Цель: Реализует UserDetails для интеграции с Spring Security. Содержит данные логина, пароля, имени, а также путь к личной папке.

`FileUploadProgressListener`
Функция: Следит за прогрессом загрузки.
Цель: Обновляет процент выполнения загрузки файла для передачи через SSE.

Репозитории:

`FileRepository`
Функция: Интерфейс для работы с файлами в БД.
Цель: Предоставляет методы поиска файлов по пользователю или ID (например, findByUser).

`UserRepository`
Функция: Интерфейс для работы с пользователями в БД.
Цель: Обеспечивает поиск пользователя по логину (findByUsername).

Безопасность:

`SecurityConfig`
Функция: Конфигурирует безопасность приложения.
Цель: Настраивает доступ к эндпоинтам, форму входа, шифрование паролей (BCrypt), правила аутентификации.

`UserDetailsServiceImpl`
Функция: Загружает данные пользователя из БД.
Цель: Реализует UserDetailsService для интеграции с Spring Security. Используется при аутентификации.

Всего 14 классов, объединенных в MVC-архитектуру.
Контроллеры обрабатывают HTTP-запросы.
Сервисы реализуют бизнес-логику.
Модели описывают данные.
Репозитории обеспечивают доступ к БД.
Безопасность гарантирует аутентификацию и авторизацию.

Эндпоинты : 6 (login, signup, home, upload, delete, download).

Технологии :

Spring Boot, Spring Security, PostgreSQL, Thymeleaf.
Паттерны : MVC, Repository, Service Layer.

### Скриншоты работоспособности

1. Страница входа  
   ![login](https://github.com/user-attachments/assets/3c613176-885d-4152-97c3-7e508e2b2262)

2. Страница регистрации  
   ![signup](https://github.com/user-attachments/assets/a7deb37d-3c9b-4c38-85ab-fc7567256ae0)

3. Домашняя страница с файлами  
   ![home](https://github.com/user-attachments/assets/45f78987-d546-439c-b713-8d5548ddaadb)

Сервис решает задачи безопасного хранения файлов c аутентификацией по учетными записям. Реализуются все функции ТЗ, включая аутентификацию, CRUD-операции с файлами.

### Команда:  
- Артеев Е.: Frontend.  
- Поздняков С.: Backend.  
- Шестакова В.: Testing.  
